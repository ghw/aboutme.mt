<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>A.4. 使用 CTM</title><link rel="stylesheet" type="text/css" href="docbook.css" /><link rev="made" href="doc@FreeBSD.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="FreeBSD 使用手册" /><link rel="up" href="mirrors.html" title="Appendix A. 获取 FreeBSD" /><link rel="prev" href="anoncvs.html" title="A.3. 匿名 CVS（已取消）" /><link rel="next" href="svn.html" title="A.5. 使用 Subversion" /><link rel="copyright" href="legalnotice.html" title="版权声明" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">A.4. 使用 CTM</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="anoncvs.html">Prev</a> </td><th width="60%" align="center">Appendix A. 获取 FreeBSD</th><td width="20%" align="right"> <a accesskey="n" href="svn.html">Next</a></td></tr></table><hr /></div><div class="sect1"><div xmlns="" class="titlepage"><div><div><h2 xmlns="http://www.w3.org/1999/xhtml" class="title" style="clear: both"><a id="ctm"></a>A.4. 使用 CTM</h2></div></div></div><a id="idp91125456" class="indexterm"></a><p><span class="application">CTM</span> 是保持远程目录树和中央服务器目录树同步的一种方法。
        它被开发用于 FreeBSD 的源码树， 虽然其他人随着时间推移会发现它可以用于其他目的。 当前几乎没有，
        也或者只有很少的文档讲述创建 deltas 的步骤， 所以如果您希望使用 CTM 去做其它事情，
        请联系 <span class="application">CTM</span> 邮件列表了解更多信息。</p><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91127248"></a>A.4.1. 为什么要使用 <span class="application">CTM</span> ？</h3></div></div></div><p><span class="application">CTM</span> 会给您一份 FreeBSD 源码树的本地副本。 代码树有很多的 <span class="quote">“<span class="quote">flavors</span>”</span> 可用。
          不管您是希望跟踪完整的 CVS 树还是只是一个分支， <span class="application">CTM</span> 都会未您提供信息。
          如果您是 FreeBSD 的一个活跃的开发者， 但是缺乏或者不存在 TCP/IP 连接， 或者只是希望把变化自动发送给您，
          <span class="application">CTM</span>  就适合您的。对于最活跃的分支， 您将会每天获得三个以上的 deltas 。
          然而， 您应该考虑通过邮件来自动发送。 升级的大小总是保证尽可能的小。 通常小于 5K， 也偶然(十分之一可能)会有 10-50K，
          也不时地有个大的 100K+ 甚至更大的。</p><p>您也需要让自己了解直接和开发代码而不是预发行版本打交道的各种警告。 这种情况会很显著，
          如果您选择了 <span class="quote">“<span class="quote">current</span>”</span> 代码的话。 强烈建议您阅读 <a class="link" href="current-stable.html#current" title="23.5.1. 使用最新的 FreeBSD CURRENT"> 和 FreeBSD 保持同步</a> 。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91135696"></a>A.4.2. 我需要什么才能使用 <span class="application">CTM</span> ？</h3></div></div></div><p>您需要两样东西： <span class="application">CTM</span> 程序， 还有初始的 deltas 来 feed it(达到 <span class="quote">“<span class="quote">current</span>”</span> 级别)。</p><p><span class="application">CTM</span> 程序从2.0 版本发布以来， 就已经 FreeBSD 的一部分了，如果您安装了源代码副本的话，
          它位于 <code class="filename">/usr/src/usr.sbin/ctm</code> 。</p><p>您喂给 <span class="application">CTM</span> <span class="quote">“<span class="quote">deltas</span>”</span> 可以有两种方式， FTP 或者 email。
          如果您有普通的访问互联网的 FTP 权限， 那么下面的 FTP 站点支持访问 <span class="application">CTM</span>：</p><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p><p>或看看这一小节 <a class="link" href="ctm.html#mirrors-ctm" title="A.4.9. CTM 镜像">镜像</a> 。</p><p>FTP 访问相关的目录并取得 <code class="filename">README</code> 文件， 从那里开始。</p><p>如果您希望通过 email 获得您的 deltas：</p><p>订阅一个 <span class="application">CTM</span> 分发列表。
          <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-cur" target="_top">ctm-src-cur</a> 支持完整的 Subversion 树。 <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-cur" target="_top">ctm-src-cur</a> 支持最新的开发分支。
          <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-src-9" target="_top">ctm-src-9</a> 支持 9.X 发行分支， 等等。(如果您不知道如何订阅邮件列表，
          点击上面的列表名或者到 <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo" target="_top">http://lists.FreeBSD.org/mailman/listinfo</a> 点击您希望订阅的列表。 列表页包含了所有必要的订阅指导。)</p><p>当您开始接收到您邮件中的 <span class="application">CTM</span> 升级时， 您可以使用 <code class="command">ctm_rmail</code> 程序来解压并应用它们。
          事实上如果您想要让进程以全自动的形式运行的话，
          您可以通过在 <code class="filename">/etc/aliases</code> 中设置直接使用 <code class="command">ctm_rmail</code> 程序。
          查看 <code class="command">ctm_rmail</code> 的联机手册了解更多细节。</p><div xmlns="" class="note"><h3 class="admontitle">Note: </h3><p xmlns="http://www.w3.org/1999/xhtml">不管您使用什么方法得到 <span class="application">CTM</span> deltas ，您都应该订阅 <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-announce" target="_top">ctm-announce</a> 邮件列表。
              未来， 这将是公布有关 <span class="application">CTM</span> 系统的操作公告的唯一的地方。
              点击上面的邮件列表名并按照指示订阅邮件列表。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91154896"></a>A.4.3. 初次使用 <span class="application">CTM</span></h3></div></div></div><p>在您开始使用 <span class="application">CTM</span> deltas 之前，您需要获得一个起始点。</p><p>首先您应该确定您已经有了什么。 每个人都可以从一个 <span class="quote">“<span class="quote">空</span>”</span> 目录开始。
          您必须用一个初始的 <span class="quote">“<span class="quote">空</span>”</span> 的 delta 来开始您的 <span class="application">CTM</span> 支持树。
          曾经为了您的便利这些 <span class="quote">“<span class="quote">起始</span>”</span> deltas 被有意的通过 CD 来发行， 然而现在已经不这样做了。</p><p>因为代码树有数十兆字节， 您应该更喜欢从手头上已经有的东西开始。 如果您有一张 -RELEASE CD 光盘，
          您可以从里面复制或者解压缩一份初始代码出来。 这会节省非常多的数据传输量。</p><p>您会发现这些 <span class="quote">“<span class="quote">初始</span>”</span> 的 deltas 名字的数字后面都有个 <code class="literal">X</code> (比如 <code class="filename">src-cur.3210XEmpty.gz</code>)。
          后面加一个 <code class="literal">X</code> 的设计符合您的初始 <span class="quote">“<span class="quote">seed</span>”</span> 的由来。 <code class="filename">Empty</code> 是一个空目录。
          通常一个基本的从 <code class="literal">Empty</code> 开始的转换由 100 个 deltas 构成。 顺便说一下， 他们都很大！
          70 到 80 兆字节的 <code class="command">gzip</code> 压缩的数据对于 <code class="filename">XEmpty</code> deltas 是很平常的。</p><p>一旦您已经选定了一个基本的 delta 开始， 您就需要比这个数高的所有的 delta。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91183952"></a>A.4.4. 在日常生活中使用 <span class="application">CTM</span></h3></div></div></div><p>要应用 deltas， 简单输入以下命令：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /where/ever/you/want/the/stuff</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -v -v /where/you/store/your/deltas/src-xxx.*</code></strong></pre><p><span class="application">CTM</span> 能够理解被 <code class="command">gzip</code> 压缩的 deltas ，
          所以您不需要先用 <code class="command">gunzip</code> 解压它们， 这能节省磁盘空间。</p><p>除非觉得整个过程非常可靠， <span class="application">CTM</span> 不会涉及到您的代码树的。
          您也可以使用 <code class="option">-c</code> 选项来校验 delta ， 这样 <span class="application">CTM</span> 就不会涉及代码树；
          它会只校验 delta 的完整性看看是否可以安全的用于您的当前代码树。</p><p><span class="application">CTM</span> 还有其他的一些参数， 查看联机手册或者源码了解更多信息。</p><p>这真的就是全部的事情了。 每次得到一个新的 delta， 就通过 <span class="application">CTM</span> 运行它来保证您的代码是最新的。</p><p>如果这些 deltas 很难重新下载的话不要删除它们。 有些东西坏掉的时候您会想到保留它们的。
          即使您只有软盘， 也请考虑使用 <code class="command">fdwrite</code> 来做一份副本。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91196496"></a>A.4.5. 维持您本地变更</h3></div></div></div><p>作为一名开发者喜欢实验， 改动代码树中的文件。 <span class="application">CTM</span> 支持有限的本地修改：
          变更 <code class="filename">foo</code> 文件之前， 先查找 <code class="filename">foo.ctm</code> 是否存在。
          如果这个文件存在， <span class="application">CTM</span> 会对它操作而不是 <code class="filename">foo</code> 。</p><p>这种行为给我们提供了一种简单的方式来维持本地的改动： 只要复制您计划修改的文件并用 <code class="filename">.ctm</code> 的后缀重新命名。
          然后就可以自由的修改代码了， <span class="application">CTM</span> 会更新 <code class="filename">.ctm</code> 文件到最新版本。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91201232"></a>A.4.6. 其他有趣的 <span class="application">CTM</span> 选项</h3></div></div></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91202384"></a>A.4.6.1. 正确的找出哪些将被更新</h4></div></div></div><p>您可以确定变动列表， <span class="application">CTM</span> 可以做到，
        在您的代码库上使用 <span class="application">CTM</span> 的 <code class="option">-l</code> 选项。</p><p>这很有用如果您想要保存改动的日志， pre- 或者 post- 用各种风格处理修改的文件的纪录， 或者仅仅是想感受一下孩子般的疯狂。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91205072"></a>A.4.6.2. 在升级前制作备份</h4></div></div></div><p>有时您可能想备份将要被 <span class="application">CTM</span> 升级所改动的所有文件。</p><p>指定 <code class="option">-B backup-file</code> 选项将会把 <span class="application">CTM</span> 备份将要被给定的
        <span class="application">CTM</span> delta 改动的所有文件到 <code class="filename">backup-file</code> 。</p></div><div class="sect3"><div xmlns="" class="titlepage"><div><div><h4 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91208528"></a>A.4.6.3. 限定受升级影响的文件</h4></div></div></div><p>有时您可能对限定一个给定的 <span class="application">CTM</span> 升级的范围感兴趣，
        也有可能想知道怎样从一列 deltas 中解压缩一部分文件。</p><p>您可以通过使用 <code class="option">-e</code> 和 <code class="option">-x</code> 选项指定过滤规则表达式来控制
        <span class="application">CTM</span> 即将对之操作的文件列表。</p><p>例如， 要从您保存的 <span class="application">CTM</span> deltas 集里解压缩出一个最新的 <code class="filename">lib/libc/Makefile</code> 文件，使用这个命令：</p><pre class="screen"><code class="prompt">#</code> <strong class="userinput"><code>cd /where/ever/you/want/to/extract/it/</code></strong>
<code class="prompt">#</code> <strong class="userinput"><code>ctm -e '^lib/libc/Makefile' ~ctm/src-xxx.*</code></strong></pre><p>对于每一个在 <span class="application">CTM</span> delta 中指定的文件，
        <code class="option">-e</code> 和 <code class="option">-x</code> 选项按照命令行给定的顺序应用。
        文件只有在所有的 <code class="option">-e</code> 和 <code class="option">-x</code> 被应用之后标记为合格之后才能被 <span class="application">CTM</span> 操作。</p></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91217360"></a>A.4.7. <span class="application">CTM</span> 未来的计划</h3></div></div></div><p>其中几项：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>在 <span class="application">CTM</span> 中使用一些认证方式， 这样来允许察觉冒充的 <span class="application">CTM</span> 补丁。</p></li><li class="listitem"><p>整理 <span class="application">CTM</span> 的选项， 它们变得杂乱而违反直觉了。</p></li></ul></div></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="idp91226192"></a>A.4.8. 杂项</h3></div></div></div><p>也有一系列的 <code class="literal">ports</code> collection 的 deltas， 但是人们对它的兴致还没有那么高。</p></div><div class="sect2"><div xmlns="" class="titlepage"><div><div><h3 xmlns="http://www.w3.org/1999/xhtml" class="title"><a id="mirrors-ctm"></a>A.4.9. CTM 镜像</h3></div></div></div><p><a class="link" href="ctm.html" title="A.4. 使用 CTM">CTM</a>/FreeBSD 可以在下面的镜像站通过匿名 FTP 获得。 如果您选择通过匿名 FTP 获取 <span class="application">CTM</span> ，
          请试着使用一个离您较近的镜像站。</p><p>如果有问题， 请联系 <a class="link" href="http://lists.FreeBSD.org/mailman/listinfo/ctm-users" target="_top">ctm-users</a> 邮件列表。</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">加利福尼亚州， 旧金山湾区， 官方源代码</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">南非， 旧的 deltas 的备份服务器</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/" target="_top">ftp://ftp.za.FreeBSD.org/pub/FreeBSD/CTM/</a></code></p></li></ul></div></dd><dt><span class="term">中国台湾</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm2.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li><li class="listitem"><p><code class="uri"><a class="uri" href="ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/" target="_top">ftp://ctm3.tw.FreeBSD.org/pub/FreeBSD/development/CTM/</a></code></p></li></ul></div></dd></dl></div><p>如果您在您附近找不到镜像或者镜像不完整， 试着使用搜索引擎比如 <a class="link" href="http://www.alltheweb.com/" target="_top">alltheweb</a> 。</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="anoncvs.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="mirrors.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="svn.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">A.3. 匿名 CVS（已取消） </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> A.5. 使用 <span class="application">Subversion</span></td></tr></table></div><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>本文档和其它文档可从这里下载：
    <a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/">ftp://ftp.FreeBSD.org/pub/FreeBSD/doc/</a>.</small></p><p xmlns="http://www.w3.org/TR/xhtml1/transitional" align="center"><small>如果对于FreeBSD有问题，请先阅读
    <a href="http://www.FreeBSD.org/docs.html">文档</a>，如不能解决再联系
    &lt;<a href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&gt;.<br></br>
    关于本文档的问题请发信联系
    &lt;<a href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&gt;.</small></p></body></html>